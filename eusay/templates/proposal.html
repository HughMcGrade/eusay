{% extends "base.html" %}

{% load static %}
{% load filters %}

{% block js %}

<script src="{% static "js/jquery.form.js" %}"></script>
<script src="{% static "js/jquery.cookie.js" %}"></script>

<script>
$(document).ready(function() {
<<<<<<< Updated upstream
<<<<<<< Updated upstream
<<<<<<< Updated upstream
    $('form').each(function(index, form) {
	$(form).ajaxForm({ complete : function() {
=======
    $('#comment_form').ajaxForm({ complete : function() { 
>>>>>>> Stashed changes
=======
    $('#comment_form').ajaxForm({ complete : function() { 
>>>>>>> Stashed changes
=======
    $('#comment_form').ajaxForm({ complete : function() { 
>>>>>>> Stashed changes
			reloadComments(document.getElementById('comments_div'), '{{ proposal.id }}', null);
    }});
});
</script>

{% endblock %}

{% block content %}

{% if hide %}
<h1>This proposal has been hidden: {{ hide.reason }}</h1>
<br />
<a id="unhide_link" class="accordion-toggle" href="#hide_accordion" data-toggle="collapse">View Proposal</a>
<div id="hide_accordion" class="accordion-body collapse" style="height: auto; margin-left: 40px;">
{% endif %}

<div class="row">
    <div class="column-xs-12">
    <h2>{{ proposal.title }}</h2>
    </div>
</div>
<div class="row">
    <div class="col-xs-12">
        <p>Tags: {% for tag in proposal.tags.all %}<a class="tag" href="/tag/{{ tag.id }}">{{ tag.name }}</a>{% endfor %}</p>
    </div>
</div>
<div class="row">
    <div id="proposal_vote_div_{{ proposal.id }}">
	    <script language="Javascript">
		    setProposalVoteDiv('{{ proposal.id }}', document.getElementById('proposal_vote_div_{{ proposal.id }}'));
	    </script>
    </div>
    {% if user.isModerator and not hide%}
    <div>
      <a href="/hide_proposal/{{ proposal.id }}">Hide Proposal</a>
    </div>
    {% endif %}
    <div class="col-xs-8"></div>
</div>

<div class="row">
    <div class="col-xs-12">
        <h3>What will we do?</h3>
    </div><!-- /column -->
</div><!-- /row -->
<div class="row">
    <div class="col-xs-12">
        <div class="textbox">
            <p>{{ proposal.actionDescription|my_markdown }}</p>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-xs-12">
        <h3>What is the background to this?</h3>
    </div>
</div>
<div class="row">
    <div class="col-xs-12">
        <div class="textbox">
            <p>{{ proposal.backgroundDescription|my_markdown }}</p>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-xs-12">
        <h3>What beliefs motivate the actions you propose?</h3>
    </div>
</div>
<div class="row">
    <div class="col-xs-12">
        <div class="textbox">
            <p>{{ proposal.beliefsDescription|my_markdown }}</p>
        </div>
    </div>
</div>

<div class="row">
  <div id="full_comment_div" class="comments">
    <p id="reply_to_div"></p>
    <form id="comment_form" method="post" action="">
      {% csrf_token %}
      <div class="form-group">
	{{ form.text }}
	<input id="reply_to" type="hidden" name="reply_to" value="" />
      </div>
      <button type="post" class="btn btn-default">Submit</button>
    </form>
    <div id="comments_div" class="comment">
      {% include 'proposal_comments.html' %}
    </div>
  </div>
</div>

{% if hide %}

</div>

{% endif %}

{% endblock %}
